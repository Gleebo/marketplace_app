<article class="flex flex-col w-11/12 h-11/12 p-2 space-y-2 border border-solid m-auto rounded-lg shadow-uniform sm:w-3/5 md:flex-row md:space-x-2 md:w-3/4 md:max-w-3xl">
  <header class="flex-1">
    <p id="notice"><%= notice %></p>
    <h1 class="text-lg"><%= @listing.title %></h1>
    <div class="w-full h-72 bg-yellow-500">
        <% if @listing.photo.attached? %>
          <%= image_tag @listing.photo, class: "object-cover h-full w-full" %>
        <% end %>
      </div>
  </header>
  <main class="flex-1 flex flex-col">
    <p><%= @listing.category.name %></p>
    <p class="text-base h-20 md:flex-1 md:pl-5">
      <%= @listing.description %>
    </p>
    <div class="text-lg text-center">AU$<%= @listing.price.to_f/100 %></div>

    <button id="checkout" class="h-12 w-11/12 text-lg rounded-full bg-yellow-500 text-white self-center">Buy</button>
  </main>

</article>

<script src="https://js.stripe.com/v3/"></script>
<script>
  document.getElementById("checkout").addEventListener("click", () => {
    const stripe = Stripe("<%= Rails.application.credentials.dig :stripe, :public_key %>");
    stripe.redirectToCheckout({
      sessionId: "<%= @session_id %>"
    });
  });
</script>